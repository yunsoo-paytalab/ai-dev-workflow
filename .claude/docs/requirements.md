# QA Tool 웹 개발 요구사항

> 기획서 버전: v0.4
> 작성일: 2025-11-24
> 기획서 출처: [QA 비효율 개선_S1] 킥오프 피드백 반영 기획서

---

### 유의사항

- 모든 식별자는 identifier 라고 지칭
- 데이터 매핑 레이어
  - 백엔드 dto는 /entities/{entity}/model/dto.ts 파일에 정의
  - 클라이언트 인터페이스타입은 /entities/{entity}/model/types.ts 파일에 정의
  - /entities/{entity}/model/mapper.ts 파일에 매핑 함수 작성
- 백엔드에서 계정 식별자(account_identifier) 회원 식별자 (user_identifier), 비회원 식별자(non_user_identifier)를 따로 관리하고 있음
- 페이지 탭과 페이지 내부의 탭이 존재함
  - 페이지 탭: 새로운 페이지로 이동하면 탭이 추가됨 (삭제 가능)
  - 페이지 내부 탭: 페이지 콘텐츠 내부에 존재하는 탭 (일반적인 탭, 추가/삭제
    없이 이동만 가능)
  - 페이지와 내부 탭을 왔다갔다할 때마다 "검색 조건 + 결과, form 입력 데이터"가 유지되어야 함 (다른 페이지로 이동했다가 돌아와도 유지되도록) -> 페이지 탭을 닫거나 로그아웃을 하거나 브라우저 탭을 닫으면 초기화
- 요구사항에서 "자산 관리" 기능은 일괄 제거 (기능 spec out 됨)
- 모든 전화번호 입력/검색 필드는 숫자만 입력 가능하며 자동으로 하이픈('-')이 추가됨 (UI 표출용이며 백엔드와의 통신은 항상 하이픈이 없는 값으로)
- 모든 날짜 필드는 캘린더를 사용 (날짜 형식 기본값은 YYYY-MM-DD이며 별도의 포맷팅 함수를 생성하지 말고 dayjs 라이브러리를 사용할 것)

---

## 1. 프로젝트 개요

### 1.1 목적

- **범용성**: 전사 프로젝트에서 공통으로 사용할 수 있는 표준화된 QA Tool 구축
- **안전성**: 테스트 대상으로 등록된 유저/기기에 한해서만 동작하여 운영 환경 데이터 오염 방지
- **독립성**: 기존 백오피스와 아키텍처를 분리하여 유지보수 편의성 및 배포 속도 확보

---

## 2. 기술 스택 및 아키텍처

### 2.1 웹 클라이언트

- **독립 웹 프로젝트**: 백오피스와 분리된 별도의 Web 프로젝트
- **UI/UX 원칙**: 빠른 기능 추가 및 배포를 위해 UI/UX 리소스 최소화, 기능 중심 구현
- **기술 스택**: Vite + React + TailwindCSS + TypeScript

#### 2.1.1 배포 환경 구성

**환경별 도메인 배포**

- 각 환경별로 별도의 도메인에 배포하여 점진적 배포 및 독립적인 버전 관리 가능
- 배포 도메인:
  - 개발 환경: `qa-tool-dev.passorder.co.kr`
  - 스테이징 환경: `qa-tool-stg.passorder.co.kr`
  - 운영 환경: `qa-tool.passorder.co.kr`

**환경 선택 및 API 연동**

- 각 도메인에서 로그인 시 환경 선택 가능 (dev/stg/prd)
- 선택한 환경에 따라 API 엔드포인트만 변경하여 요청
- 선택한 환경 정보는 sessionStorage 저장하여 세션 유지
- 예시: `qa-tool-stg.passorder.kr`에서 "운영(prd)" 환경 선택 시, prd API 엔드포인트로 요청

**환경별 API 엔드포인트**

- 개발 환경 API: `https://qa-api-dev.passorder.kr`
- 스테이징 환경 API: `https://qa-api-stg.passorder.kr`
- 운영 환경 API: `https://qa-api.passorder.kr`

### 2.2 서버 연동

- **QA Tool 서버**:
  - 권한 분리: 등록된 테스트 대상 외 데이터 접근/조작 차단
  - 작업 로그 자동 기록
  - 공통 기능 코어 + 프로젝트별 특수 기능 확장 구조
  - dev, stg, prod 환경으로 구분됨

### 2.3 보안 및 접근 제어

- **인증**: 기존 백오피스 계정 DB 기반 인증
- **권한**: QA Tool 진입 권한을 가진 계정만 로그인 가능

---

## 3. 주요 화면 및 기능

### 3.1 로그인 화면

**참고 자료**: [Login Page for QA Tool - Figma](https://www.figma.com/make/ikOYCmnChYswlEIbClO11a/Login-Page-for-QA-Tool)

#### 기능 요구사항

| 기능               | 상세 내용                                                                                              |
| ------------------ | ------------------------------------------------------------------------------------------------------ |
| **접속 환경 선택** | - 드롭다운으로 환경 선택 (개발/스테이징/운영)<br>- 환경 선택 후 ID/PW 입력 가능                        |
| **ID/PW 입력**     | - 백오피스 계정 정보 입력<br>- 비밀번호는 항상 hidden 상태<br>- [로그인] 버튼 제공                     |
| **로그인 실행**    | - 인증 API 호출<br>- 성공: 메인 대시보드 이동<br>- 실패: "아이디 또는 비밀번호를 확인해주세요." 토스트 |
| **권한 체크**      | - QA tool 진입 권한 검증<br>- 권한 없을 시: 로그인 실패 토스트                                         |

#### 상세 요구사항

##### 1. 접속 환경 선택

**로직**

- 사용자는 드롭다운 메뉴를 통해 개발 환경, 스테이징 환경, 또는 운영 환경 중 하나를 선택합니다.

**상태 관리**

- 환경을 선택하기 전까지는 아이디와 비밀번호 입력 필드가 비활성화 상태(disabled)로 유지됩니다.
- 로그인 버튼은 '환경을 선택하세요'라는 텍스트와 함께 비활성화됩니다.
- 환경을 선택하면 입력 필드와 로그인 버튼이 활성화됩니다.

**엣지 케이스**

- 환경 미선택 시 다음 단계(로그인) 진행을 차단합니다.

##### 2. ID/PW 입력 폼

**로직**

- 사용자는 기존 백오피스 아이디와 비밀번호를 입력 필드에 입력합니다.
- **계정 유형**:
  - dev, staging: 프로덕트 공용 계정
  - prd: 개인 계정

**상태 관리**

- 비밀번호 입력 필드는 항상 숨김(hidden) 상태로 노출됩니다.

**엣지 케이스**

- 사용자가 환경을 선택하지 않은 경우 입력 필드가 비활성화됩니다.

##### 3. 로그인 실행

**로직**

- 사용자가 [로그인] 버튼을 클릭하면, 입력된 정보로 인증 API를 호출합니다.

**상태 관리**

- 로그인 실행 중에는 로그인 버튼이 비활성화 상태(disabled)가 되어 중복 클릭을 방지합니다.

**엣지 케이스**

- 환경, 아이디, 비밀번호 중 하나라도 입력하지 않은 경우 로그인 시도를 하지 않습니다.
- 인증 API 호출에 실패하거나, QA Tool 진입 권한이 없는 계정인 경우 '아이디 또는 비밀번호를 확인해주세요.'라는 오류 메시지(Toast)를 노출합니다.

##### 4. 로그인 성공

**로직**

- 인증 API 호출 및 권한 체크에 성공하면 메인 대시보드로 이동합니다.

**상태 관리**

- 로그인 성공 시, '로그인 성공!' 메시지(Toast)가 잠시 노출되고 대시보드 페이지로 이동합니다.

**엣지 케이스**

- 인증 실패 시 이동하지 않고 오류 메시지를 노출합니다.

#### UI 구성 요소

- **페이지 제목**: "QA Tool"
- **부제목**: "백오피스 계정으로 로그인해주세요"
- **환경 드롭다운**: 플레이스홀더 "환경을 선택하세요"
- **아이디 입력 필드**: 플레이스홀더 "아이디를 입력하세요"
- **비밀번호 입력 필드**: 플레이스홀더 "비밀번호를 입력하세요" (항상 숨김 상태)
- **로그인 버튼**: 환경 미선택 시 비활성화, 선택 시 활성화

---

### 3.2 대시보드

**참고 자료**: [QA Tool UI Structure_2 - Figma](https://www.figma.com/make/Znt2LDbkL1f301dQGjLCto/QA-Tool-UI-Structure_2)

#### 기능 요구사항

| 영역               | 상세 내용                                                                                                                                       |
| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| **접속 환경 현황** | - 현재 선택된 접속 환경(dev, stg, prod) 표시<br> - 선택된 접속 환경의 테스트 계정/번호/매장 개수 표시<br>- QA 플로우 상 테스트 대상 리셋 확인용 |
| **즐겨찾기**       | - 로그인한 사용자별 자주 사용하는 작업 등록<br>- 클릭 시 해당하는 페이지로 이동                                                                 |
| **계정 정보**      | - 로그인한 계정 정보 표시(이름, 권한, 이메일 등)<br>- [로그아웃] 버튼                                                                           |

#### 상세 요구사항

##### 1. 사이드바 (Sidebar)

**로직**

- 각 페이지 항목은 페이지로 이동을 처리하며, 이와 동시에 페이지 탭을 생성하거나 활성화합니다.
- 주요 메뉴 항목:
  - 대시보드
  - 테스트 환경 관리
  - 패써 관리 (계정 관리)
  - 매장 관리
  - 메시지 관리

**상태 관리**

- 현재 활성화된 페이지와 일치하는 사이드바 항목은 시각적으로 강조됩니다.

**프로젝트별 기능**

- 추후 프로젝트별 tool이 생성됨을 고려하여 메인 메뉴 가장 하단에 토글로 나열할 수 있도록 합니다.
- 예시: 패써 프로젝트, 매장 관리 프로젝트, 메시지 발송 프로젝트

**접속 환경 표시**

- 사이드바 하단에 위치하며, 현재 development(개발), staging(스테이징), production(운영) 중 하나의 환경을 텍스트로 표시합니다.
- 해당 접속 환경은 로그인 시 선택한 [환경]을 기준으로 표시됩니다.

##### 2. 접속 환경 현황

**로직**

- 현재 선택된 접속 환경에 맞춰 테스트 대상의 개수를 각각 집계하여 대시보드에 표시합니다.
- 표시 항목:
  - 테스트 계정 개수
  - 테스트 허용 번호 개수
  - 테스트 매장 개수

**엣지 케이스**

- production 환경을 선택할 경우, 허용 휴대폰 번호 카운트는 운영 환경 전용 테스트 허용 번호 리스트를 반영합니다.

##### 3. 즐겨찾기

**로직**

- 사용자가 등록한 즐겨찾기 목록을 저장 및 관리하며, 대시보드에 표시합니다.
- 즐겨찾기 항목은 페이지 ID와 탭 ID를 포함하여 특정 기능 경로를 식별합니다.

**상태 관리**

- 목록에 표시된 항목은 페이지 ID와 탭 ID 기반의 레이블(예: '테스트 환경 관리 > 테스트 계정 관리')을 함께 보여줍니다.

**엣지 케이스**

- 생성된 페이지 내 모든 탭 우측의 즐겨찾기 표시로 항목 추가/제거가 가능합니다.
- 즐겨찾기가 없을 경우 텍스트 노출: "즐겨찾기가 없습니다. 자주 사용하는 작업을 등록해보세요."

##### 4. 계정 정보 및 로그아웃

**화면 상단 헤더의 사용자 칩**

- 현재 로그인한 사용자(이름 + '님')의 정보를 표시합니다.
- 예시: "신정현 님 (Admin)"

**대시보드 화면 [계정 정보] 카드**

- 현재 로그인한 사용자의 정보(이름, 메일 주소)를 노출합니다.
- 하단의 로그아웃 버튼은 클릭 시 로그인 화면으로 랜딩되는 기능을 제공해야 합니다.

#### UI 구성 요소

- **페이지 제목**: "대시보드"
- **부제목**: "QA Tool의 전체 현황을 한눈에 확인하세요."
- **접속 환경 현황 카드**: 환경명 표시 (예: "Development", "Staging", "Production")
- **통계 카드**: 테스트 계정, 테스트 허용 번호, 테스트 매장 개수 표시
- **즐겨찾기 영역**: 즐겨찾기 목록 또는 빈 상태 메시지
- **계정 정보 카드**: 사용자 프로필, 이름, 권한, 이메일, 로그아웃 버튼

---

### 3.3 테스트 환경 관리

**참고 자료**: [QA Tool UI Structure_2 - Figma](https://www.figma.com/make/Znt2LDbkL1f301dQGjLCto/QA-Tool-UI-Structure_2)

#### 3.3.1 테스트 계정 생성

**목적**: CI 값 및 개인정보 관리 가능한 테스트 계정 생성, 본인인증 비용 절감

##### 계정 유형 선택

- **회원**: 전체 필수/선택 정보 입력 가능
- **비회원**: 닉네임, 휴대폰 번호만 입력

##### 필수 정보 입력

| 항목                   | 입력 형식                                                                                                                                                  |
| ---------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ID (로그인 아이디)** | - 형식: `p#{1자리 영문 + 3자리 숫자}@이메일` (예: pa123@passorder.qa)<br>- 랜덤 기본값 제공, 수정 가능 (중복 불가)<br>- 랜덤 생성 버튼 제공                |
| **비밀번호**           | - 기본값: `paytalab1!`<br>- 수정 가능                                                                                                                      |
| **결제 비밀번호**      | - 6자리 숫자 입력<br>- 플레이스홀더: "숫자 6자리 입력"                                                                                                     |
| **닉네임**             | - 형식: `qatester#{6자리 영문+숫자}` (예: qatesterabc123)<br>- 랜덤 기본값 제공, 수정 가능<br>- 랜덤 생성 버튼 제공                                        |
| **휴대폰 번호**        | - 숫자 입력 필드 (하이픈 없이 숫자만 입력)<br>- 플레이스홀더: "'-' 없이 숫자만 입력"<br>- 안내 텍스트: "QA 서버 번호로 등록되며 계정 통합에서 제외됩니다." |

##### 선택 정보 입력

| 항목           | 입력 형식                                                                               |
| -------------- | --------------------------------------------------------------------------------------- |
| **이름**       | 텍스트 입력                                                                             |
| **생년월일**   | 날짜 선택 (YYYY-MM-DD 형식)                                                             |
| **성별**       | 남/여 라디오 버튼 선택                                                                  |
| **CI 값 처리** | 1. 자동 생성 (기본값): 임의 CI 값 미리보기 필드 표시<br>2. 직접 입력: CI 값 텍스트 입력 |

##### 계정 목록 관리

**테이블 구성**

- **컬럼**: ID, 회원 식별자, 닉네임, 휴대폰 번호, 생성일, 관리
- **복사 버튼**: ID와 회원 식별자 필드 옆에 복사 버튼 제공
- **삭제 버튼**: 각 행의 관리 컬럼에 삭제 버튼 제공

**UI 구성 요소**

- 페이지 제목: "테스트 환경 관리"
- 부제목: "QA Tool에서 사용할 테스트 환경 데이터를 관리합니다."
- 탭 네비게이션: 테스트 계정 관리, 테스트 허용 번호, 테스트 매장 등록
- 설명 텍스트: "QA Tool에서 생성된 테스트 계정 목록입니다."
- 신규 계정 생성 버튼: 우측 상단 배치

##### 삭제 조건

- 해당 계정의 모든 주문 건이 '주문 취소' 상태여야 삭제 가능

---

#### 3.3.2 테스트 허용 번호 관리

**목적**: 릴리즈 환경 회원가입 절차 테스트 지원, QA 서버 번호 중복 허용

##### 기능 상세

- **화이트리스트 등록**
  - 테스터 휴대폰 번호 추가/삭제
  - Production 환경: 법인 테스트폰 번호만 기등록 (추가 불가)
  - 화이트리스트 등록 기간 동안 가입한 계정은 계정 통합 대상 제외
  - 해당 기간 가입 계정은 '테스트 계정' 목록에 자동 포함

##### 번호 등록 폼

**UI 구성 요소**

- 제목: "신규 번호 등록"
- 입력 필드: 휴대폰번호 (하이픈 없이 숫자만 입력)
- 플레이스홀더: "'-' 없이 숫자만 입력 (예: 01012345678)"
- 등록하기 버튼: 우측 배치

##### 번호 목록 관리

**테이블 구성**

- **컬럼**: 휴대폰 번호, 등록자, 등록일, 관리
- **삭제 버튼**: 각 행의 관리 컬럼에 삭제 버튼 제공

**Production 환경 특수 처리**

- **운영 환경 모드 안내**:
  - 아이콘과 함께 안내 메시지 표시
  - "운영 환경에서는 사전 등록된 테스트 허용 번호만 조회 가능합니다. 신규 번호 등록은 개발 환경에서 진행해주세요."
- **신규 번호 등록 폼**: Production 환경에서는 등록 폼이 표시되지만, 실제 등록은 불가능하도록 처리

##### Production 환경 법인 테스트폰 번호 (18개)

```
010-5165-8221, 010-3413-8220, 010-4387-8214, 010-8429-4213
010-8436-4208, 010-9619-4210, 010-6795-4215, 010-4384-8212
010-4386-8213, 010-4384-8215, 010-2872-2495, 010-8175-3012
010-8185-3012, 010-3945-8220, 010-7920-8220, 010-8544-8220
010-8429-3012
```

**등록자 정보**

- Production 환경의 법인 테스트폰 번호는 "시스템 관리자"로 등록자 표시
- 등록일은 시스템 초기화일로 표시 (예: 2025-01-01)

##### 삭제 조건

- 해당 번호로 생성된 모든 계정 삭제 후 전화번호 삭제 가능

---

#### 3.3.3 테스트 매장 등록

**목적**: 실제 운영 매장 데이터 보호, 테스트 환경 매장만 조작 가능

##### 등록 프로세스

1. **매장 검색**

   - 매장 ID 또는 매장명으로 기존 DB 검색
   - 입력 필드: "매장 식별자 또는 매장명"
   - 플레이스홀더: "예: S10001 또는 '강남'"
   - 검색 버튼: 우측 배치

2. **검색 결과 표시**

   - 검색 결과 목록: 매장명, ID, 주소 정보 표시
   - 등록 상태 표시: 이미 등록된 매장은 "등록됨" 텍스트 표시
   - 미등록 매장: "등록" 버튼 제공
   - 페이지네이션: 검색 결과가 많을 경우 페이지네이션 제공

3. **매장 등록**

   - 검색 결과에서 [등록] 버튼 클릭
   - **운영(Production) 환경 안전장치 (필수)**:
     - 사업자번호 `452-87-01123` 또는 매장명에 "패스오더" 포함된 매장만 등록 가능
     - 조건 미충족 시 경고 다이얼로그: "실제 고객이 사용하는 매장이 아닌지 확인하십시오."

4. **등록된 매장 목록**
   - 테이블 구성: 매장 식별자, 매장명, 등록일, 관리
   - 매장 식별자 옆 복사 버튼 제공
   - 삭제 버튼: 각 행의 관리 컬럼에 삭제 버튼 제공
   - 페이지네이션: 등록된 매장 목록이 많을 경우 페이지네이션 제공

**UI 구성 요소**

- 페이지 제목: "테스트 환경 관리"
- 부제목: "QA Tool에서 사용할 테스트 환경 데이터를 관리합니다."
- 설명 텍스트: "기존 서비스 DB의 매장을 검색하여 QA 테스트 대상으로 등록(화이트리스팅)합니다."
- 검색 섹션: "매장 검색" 제목
- 등록된 매장 섹션: "등록된 테스트 매장 (N개) - X/Y 페이지" 형식으로 제목 표시

##### 삭제 조건

- 해당 매장의 모든 주문 건이 '주문 취소' 상태일 경우에만 삭제 가능

##### 예외 처리

- 이미 등록된 테스트 대상 재등록 시도 시 중복 방지, 경고 메시지 반환
- 검색 결과에서 이미 등록된 매장은 "등록됨" 상태로 표시하여 재등록 방지

---

### 3.4 패써 관리

#### 3.4.1 계정 목록 관리

**목적**: 전화번호별 회원 목록 관리, 비회원 테스트 지원

##### 전화번호로 계정 검색

**로직**

- 테스트 허용 전화번호로 검색하여 해당 번호에 연결된 모든 회원/비회원 정보를 조회하고 관리합니다.
- 테스트 허용 전화번호가 아닌 경우, 검색 결과가 조회되지 않습니다.
- 검색 입력 필드에 전화번호를 입력하고 검색 버튼을 클릭합니다.
- 검색 결과는 테이블 형태로 표시됩니다.

**입력 필드**

- **라벨**: "휴대폰번호"
- **입력 형식**: 하이픈 포함 전화번호 형식 (예: 010-1111-2222)
- **검색 버튼**: 우측 배치

**상태 관리**

- 검색 결과가 없을 경우 빈 상태 메시지 표시
- 검색 결과 상단에 총 계정 개수 표시 (예: "총 4개 계정")

##### 검색 결과 테이블

**테이블 구성**

- **컬럼**: 회원 식별자, 이름, 전화번호, 구분, 상태, 주문 상태, 생성일, 관리
- **회원 식별자**: 복사 버튼 제공
- **구분**: 회원 / 비회원
- **상태**: 활성 / 탈퇴
- **주문 상태**: 활성 주문 / 전체 취소
- **생성일**: YYYY-MM-DD 형식
  - 탈퇴한 회원의 경우 생성일 아래에 "탈퇴: YYYY-MM-DD" 형식으로 탈퇴일 표시

**관리 버튼**

- **회원 (활성 상태)**:
  - 탈퇴: 모든 주문 건이 '주문 취소' 상태일 때만 가능
  - 삭제: 모든 회원이 탈퇴 상태일 때만 가능
  - 수정: 계정 정보 수정 모드 진입
- **회원 (탈퇴 상태)**:
  - 삭제: 완전 삭제
  - 수정: 계정 정보 수정 모드 진입
- **비회원**:
  - 삭제: 완전 삭제
  - 수정: 계정 정보 수정 모드 진입

##### 수정 모드

**로직**

- 수정 버튼 클릭 시 해당 행이 수정 모드로 전환됩니다.
- 이름 필드가 input으로 변경되어 이름 수정이 가능합니다.
- 생성일 필드가 Date Picker로 변경되어 날짜 수정이 가능합니다.

**상태 관리**

- 수정 모드 진입 시 관리 컬럼의 버튼이 변경됩니다:
  - 저장: 변경사항 저장
  - 취소: 수정 취소 및 원래 상태로 복귀
- 수정 모드에서는 탈퇴/삭제 버튼이 숨겨집니다.

**엣지 케이스**

- 수정 중인 행이 있을 경우 다른 행의 수정 버튼은 비활성화됩니다.
- 저장 또는 취소 버튼 클릭 시 수정 모드가 해제됩니다.

##### 기능

- 하나의 전화번호에 연결된 모든 회원/비회원 정보 조회 및 수정
- **비회원**: 완전 삭제
- **회원**:
  - 탈퇴: 모든 주문 건이 '주문 취소' 상태일 때만 가능
  - 완전 삭제: 모든 회원이 탈퇴 상태일 때만 가능

##### UI 구성 요소

- 페이지 제목: "패써 관리"
- 부제목: "패써 정보를 조회하고 관리합니다."
- 설명 텍스트: "전화번호로 검색하여 해당 번호에 연결된 모든 회원/비회원 정보를 조회하고 관리합니다."
- 검색 섹션 제목: "전화번호로 계정 검색"
- 검색 결과 섹션 제목: "검색 결과"
- 검색 결과 개수 표시: "총 N개 계정"

---

#### 3.4.2 회원 정보 관리

**목적**: 회원 정보 기반 기능 및 CRM 내역 확인/수정

##### 기능

- 회원 식별자별 패써 정보 조회 및 수정
  - 패써 가입일, 생일, 성별, 마케팅 수신 동의 여부, 최근 접속일
- **세그먼트 조회 및 선택** (하이라이트 세그먼트 우선 반영)
  - 경고 토스트: "최근 주문일, 가입일 등의 연관 데이터 수동 조작 필요"
  - 번호 기준 세그먼트 동일 명시

##### 세그먼트 목록 (하이라이트 우선)

| 세그먼트           | 조건                                                                    |
| ------------------ | ----------------------------------------------------------------------- |
| **0회 주문자**     | 주문 이력 없음 + 패스오더 가입 6일 이상                                 |
| **활성 유저**      | 최근 주문일 22일 이내 + 앱 주문 수 7~30회                               |
| **이탈패써 1순위** | 최근 주문일 23일 이상 + 거래금액 18,400원 이상 + 최근 접속일 19일 이내  |
| **이탈패써 2순위** | 최근 주문일 23일 이상 + 거래금액 18,300원 이하 or 최근 접속일 20일 이상 |
| **이탈 유저**      | 최근 주문일 63일~108일 + 최근 접속일 25일 이상                          |

##### 아하모먼트 대상자 처리

- 0회 주문자 대상만 가능
- '잔수 100원 딜 금액 할인권' 생성/미사용/삭제 처리

---

#### 3.4.3 비회원 정보 관리

**목적**: 비회원 식별자 기반 비회원 정보 조회 및 수정

##### 비회원 식별자로 비회원 검색

**로직**

- 비회원 식별자로 검색하여 해당 비회원의 정보를 조회하고 관리합니다.
- 테스트 대상으로 등록된 비회원만 검색 및 조회가 가능합니다.
- 검색 입력 필드에 비회원 식별자를 입력하고 검색 버튼을 클릭합니다.

**입력 필드**

- **라벨**: "비회원 식별자"
- **입력 형식**: 텍스트 입력
- **플레이스홀더**: "비회원 식별자를 입력하세요"
- **검색 버튼**: 우측 배치

**상태 관리**

- 검색 결과가 없을 경우 빈 상태 메시지 표시
- 검색 성공 시 비회원 정보 카드 표시

##### 비회원 정보 카드

**표시 항목**

| 항목              | 설명                                 |
| ----------------- | ------------------------------------ |
| **비회원 식별자** | 비회원 고유 식별자 (복사 버튼 제공)  |
| **전화번호**      | 하이픈 포함 형식 (예: 010-1234-5678) |
| **닉네임**        | 텍스트 표시                          |
| **생일**          | YYYY-MM-DD 형식                      |
| **생성일**        | YYYY-MM-DD 형식                      |

**관리 버튼**

- **수정**: 비회원 정보 수정 모드 진입

##### 수정 모드

**로직**

- 수정 버튼 클릭 시 수정 모드로 전환됩니다.
- 수정 가능 필드:
  - **닉네임**: 텍스트 입력 필드로 변경
  - **생일**: Date Picker로 변경 (YYYY-MM-DD 형식)
  - **생성일**: Date Picker로 변경 (YYYY-MM-DD 형식)

**상태 관리**

- 수정 모드 진입 시 관리 버튼이 변경됩니다:
  - 저장: 변경사항 저장
  - 취소: 수정 취소 및 원래 상태로 복귀

**엣지 케이스**

- 저장 또는 취소 버튼 클릭 시 수정 모드가 해제됩니다.
- 닉네임은 빈 값으로 저장할 수 없습니다.

##### 기능

- 비회원 식별자별 비회원 정보 조회 및 수정
  - **조회 필드**: 비회원 식별자, 전화번호, 닉네임, 생일, 생성일
  - **수정 가능 필드**: 닉네임, 생일, 생성일

##### UI 구성 요소

- 탭 명: "비회원 정보 관리"
- 설명 텍스트: "비회원 식별자로 검색하여 비회원 정보를 조회하고 수정합니다."
- 검색 섹션 제목: "비회원 식별자로 검색"
- 검색 결과 섹션 제목: "비회원 정보"

---

### 3.5 매장 관리

#### 3.5.1 주문 이력 관리

**목적**: 매장 주문이력 기반 기능 및 CRM 확인, 주문 처리

##### 매장별 주문 내역 조회

**로직**

- 매장의 주문을 처리하고 주문 이력을 기준으로 행동하는 기능 및 CRM 내역을 확인합니다.
- 매장 식별자와 기간(시작일, 종료일)을 입력하여 주문 내역을 조회합니다.

**입력 필드**

- **매장 식별자** (필수):
  - 라벨: "매장 식별자"
  - 입력 형식: 텍스트 입력
  - 복사 버튼 제공
  - 플레이스홀더: "010101"
- **시작일**:
  - 라벨: "시작일" (아이콘 포함)
  - 입력 형식: Date Picker
- **종료일**:
  - 라벨: "종료일" (아이콘 포함)
  - 입력 형식: Date Picker
- **검색 버튼**: 우측 배치

**상태 관리**

- 검색 결과가 없을 경우 빈 상태 메시지 표시
- 검색 결과 상단에 주문 내역 개수 표시 (예: "주문 내역 (3건)")

##### 검색 결과 테이블

**테이블 구성**

- **컬럼**: 체크박스, 주문 번호, 회원 식별자, 주문 일시, 메뉴 정보, 주문 금액, 주문 상태, 작업
- **체크박스**: 전체 선택 및 개별 선택 가능
- **주문 번호**: 텍스트 표시 (예: ORD001)
- **회원 식별자**: 복사 버튼 제공
- **주문 일시**: YYYY-MM-DD HH:mm 형식 (예: 2025-11-18 14:30)
- **메뉴 정보**: 여러 줄로 표시
  - 형식: "메뉴명 x수량 (금액원)" (예: "아메리카노 x2 (9,000원)")
  - 여러 메뉴의 경우 각각 한 줄씩 표시
- **주문 금액**: 금액 형식 (예: "14,000원")
- **주문 상태**: 상태 배지로 표시
  - 상태 종류: 결제 대기, 결제 확인 중, 접수 대기, 조리 중, 조리 완료, 수령 완료, 주문 취소
- **작업**: 수정 버튼 제공

**주문 상태 수정 규칙**

- **주문 일시**: 과거 일자로 수정 가능
- **주문 상태**: 현재 상태 이전 값으로 수정 불가
  - 상태 흐름: 결제 대기 → 결제 확인 중 → 접수 대기 → 조리 중 → 조리 완료 → 픽업 완료 → 주문 취소
  - 예: 현재 상태가 "조리 완료"인 경우 "조리 중" 이전 상태로는 변경 불가

##### 수정 모드

**로직**

- 수정 버튼 클릭 시 해당 주문의 수정 모드로 전환됩니다.
- 주문 일시 필드가 Date Picker로 변경되어 날짜 및 시간 수정이 가능합니다.
- 주문 상태 필드가 드롭다운으로 변경되어 상태 수정이 가능합니다.

**상태 관리**

- 수정 모드 진입 시 작업 컬럼의 버튼이 변경됩니다:
  - 저장: 변경사항 저장
  - 취소: 수정 취소 및 원래 상태로 복귀
- 수정 중인 행이 있을 경우 다른 행의 수정 버튼은 비활성화됩니다.

**엣지 케이스**

- 주문 상태는 현재 상태보다 이전 상태로 변경할 수 없습니다.
- 저장 또는 취소 버튼 클릭 시 수정 모드가 해제됩니다.

##### 기능

- 매장 식별자별 주문 내역 조회 및 수정
  - 회원 식별자, 주문 일시, 메뉴 정보, 주문 금액 조회
  - **주문 일시**: 과거 일자로 수정 가능
  - **주문 상태**: 현재 상태 이전 값으로 수정 불가
    - 상태 흐름: 결제 대기 → 결제 확인 중 → 접수 대기 → 조리 중 → 조리 완료 → 픽업 완료 → 주문 취소

##### UI 구성 요소

- 페이지 제목: "매장 관리"
- 부제목: "전체 매장 정보를 조회하고 관리합니다."
- 설명 텍스트: "매장의 주문을 처리하고 주문 이력을 기준으로 행동하는 기능 및 CRM 내역을 확인합니다."
- 검색 섹션 제목: "매장별 주문 내역 조회"
- 검색 결과 섹션 제목: "주문 내역 (N건)"

#### 3.5.2 매장 출력물 요청

**목적**: 스니핑 데이터 활용 기능 확인

##### 기능

- 매장 식별자별 영수증 내용 DB 입력

---

### 3.6 메시지 관리

#### 3.6.1 메시지 발송 리스트 조회

**목적**: 테스트용 SMS/알림톡 메시지 관리

##### 발송 리스트 검색

**로직**

- 회원 식별자 또는 전화번호로 발송 예정 메시지를 조회하고 관리합니다.
- 검색 조건, 시작일, 종료일을 입력하여 발송 리스트를 검색합니다.

**입력 필드**

- **검색 조건** (필수):
  - 드롭다운: "회원 식별자" 또는 "전화번호" 선택
  - 입력 필드: 선택한 조건에 맞는 값 입력
  - 복사 버튼 제공
- **시작일**:
  - 라벨: "시작일" (아이콘 포함)
  - 입력 형식: Date Picker
- **종료일**:
  - 라벨: "종료일" (아이콘 포함)
  - 입력 형식: Date Picker
- **검색 버튼**: 우측 배치

**상태 관리**

- 검색 결과가 없을 경우 빈 상태 메시지 표시
- 검색 결과 상단에 발송 메시지 개수 표시 (예: "발송 메시지 목록 (3건)")

##### 발송 메시지 목록

**표시 형식**

- 카드 형태로 2열 그리드 레이아웃으로 표시
- 각 카드는 발송 메시지의 상세 정보를 포함

**카드 구성 요소**

- **상단 헤더**:
  - 상태 배지: "예약" 또는 "수신완료"
  - 구분 배지: "회원" 또는 "비회원"
  - 작업 버튼: 수정, 즉시수신/재발송, 삭제
- **회원 식별자**:
  - 라벨: "회원 식별자"
  - 값 표시 및 복사 버튼 제공
- **전화번호**:
  - 라벨: "전화번호"
  - 하이픈 포함 형식 (예: 010-1234-5678)
- **메시지 템플릿**:
  - 템플릿명 표시 (예: "예약 확인 알림")
  - 템플릿 코드 표시 (예: "RESERVE_CONFIRM")
- **변수값**:
  - 키:값 형식으로 여러 개 표시
  - 예: "userName: 김철수", "reserveDate: 2025-11-15 14:00"
  - 2열로 배치하여 표시
- **발송 예상 일시**:
  - 라벨: "발송 예상 일시"
  - YYYY-MM-DD HH:mm:ss 형식 (예: "2025-11-15 13:00:00")
- **실제 발송 일시**:
  - 라벨: "실제 발송 일시"
  - 발송 전: "-" 표시
  - 발송 후: YYYY-MM-DD HH:mm:ss 형식 (예: "2025-11-10 14:20:01")

**작업 버튼**

- **예약 상태 메시지**:
  - 수정: 발송 예상 일시 및 변수값 수정
  - 즉시수신: 예약 메시지를 즉시 발송
  - 삭제: 예약 메시지 삭제
- **수신완료 상태 메시지**:
  - 수정: 발송 예상 일시 및 변수값 수정 (과거 일시로 수정 불가)
  - 재발송: 동일한 메시지 재발송
  - 삭제: 발송 메시지 삭제

##### 수정 모드

**로직**

- 수정 버튼 클릭 시 해당 메시지의 수정 모드로 전환됩니다.
- 발송 예상 일시 필드가 Date Picker로 변경되어 날짜 및 시간 수정이 가능합니다.
- 변수값 필드가 입력 가능한 형태로 변경됩니다.

**상태 관리**

- 수정 모드 진입 시 작업 버튼이 변경됩니다:
  - 저장: 변경사항 저장
  - 취소: 수정 취소 및 원래 상태로 복귀
- 수정 중인 카드가 있을 경우 다른 카드의 수정 버튼은 비활성화됩니다.

**엣지 케이스**

- 수신완료 상태의 메시지는 발송 예상 일시를 과거 일시로 수정할 수 없습니다.
- 저장 또는 취소 버튼 클릭 시 수정 모드가 해제됩니다.

##### 기능

- 회원 식별자 or 전화번호별 발송 예정 내역 조회 및 수정
  - 대상 유저, 메시지 템플릿 정보, 변수값 확인
  - 발송 예상 일시, 실제 발송 일시 수정
  - 예약 메시지 리스트 삭제
  - 발송 메시지 즉시 수신 및 재발송

##### UI 구성 요소

- 페이지 제목: "메시지 관리"
- 부제목: "테스트용 SMS/알림톡 메시지를 관리합니다."
- 설명 텍스트: "회원 식별자 또는 전화번호로 발송 예정 메시지를 조회하고 관리합니다."
- 검색 섹션 제목: "발송 리스트 검색"
- 검색 결과 섹션 제목: "발송 메시지 목록 (N건)"

---

#### 3.6.2 메시지 & 패스링크 복사

**목적**: Production → Staging 환경으로 CRM 설정 복사 자동화

##### 복사 플로우

1. **소스 → 타겟 환경**: Production → Staging
2. **복사 타입 선택**: CRM 메시지 또는 패스링크
3. **검색**: Production 백오피스에서 생성한 메시지 그룹(CRM) 또는 템플릿명 입력
4. **불러오기**:
   - [불러오기] 버튼 클릭
   - 검색 결과 리스트 노출
   - 복사할 내역 선택
5. **실행**: 선택 항목 복사 실행

##### 자동 변환 기능

- **도메인 주소 자동 변환**
  - Production 도메인 → Staging 도메인 자동 치환
  - 예: `https://passorder.kr` → `https://stg.passorder.kr`

##### 중복 데이터 처리

1. **체크 로직**

   - Staging DB에 동일한 메시지 코드 또는 패스링크 존재 여부 조회

2. **컨펌 팝업** (중복 데이터 1건 이상 포함 시)
   - **Message**:
     > "선택하신 목록 중 이미 Staging 환경에 존재하는 데이터가 있습니다.
     > 계속 진행 시, 기존 Staging 설정은 삭제되고 Production 설정으로 덮어씌워집니다.
     > 진행하시겠습니까?"
   - **List**: 중복 항목 명칭 요약 노출 (예: 'abcdefg12345678' 외 2건)
   - **Action**:
     - 취소: 프로세스 중단
     - 확인: 기존 Prod 설정으로 최신화

---/

## 4. Tool 공통 UX

### 4.1 QA Tool 버전 관리

- QA 툴 기능 변경/추가 시 업데이트 내용 기록
- 백엔드 / 웹 개발 히스토리 구분 기록
- Notion API 연동하여 관련 페이지 필터링 '뷰어' 기능 제공

### 4.2 테스터 편의성 증대 기능

- **복사 버튼**: 모든 식별자 필드 옆 복사하기 버튼
- **페이지 탭**: 페이지 탭 추가/이동 시 검색 조건 및 데이터 상태 유지
- **검색 필터**: 시스템 성능 및 검색 효율성을 위한 이력 검색 필터값 추가
- **이력 전체 선택**: 일괄 삭제 및 수정 기능

---

## 5. API 연동 요구사항

### 5.1 환경별 API 엔드포인트

- 각 환경별로 별도의 API 서버가 운영됩니다.
- 환경별 API 엔드포인트:
  - 개발 환경: `https://qa-api-dev.passorder.kr`
  - 스테이징 환경: `https://qa-api-stg.passorder.kr`
  - 운영 환경: `https://qa-api.passorder.kr`
- 로그인 시 선택한 환경에 해당하는 API 엔드포인트로 모든 요청을 전송합니다.
- 선택한 환경 정보 및 인증 정보는 sessionStorage 저장되어 세션 동안 유지됩니다.

### 5.2 인증 API

- 백오피스 계정 DB 기반 로그인 인증
- 세션/토큰 관리
- 선택한 환경의 API 엔드포인트로 인증 요청 전송

### 5.2 테스트 대상 관리 API

- 테스트 계정 생성/조회/수정/삭제
- 테스트 허용 번호 등록/조회/삭제
- 테스트 매장 등록/조회/삭제
- 테스트 대상 유효성 검증

### 5.3 패써 관리 API

- 계정 목록 조회 (테스트 전화번호 기반)
- 회원 정보 조회/수정
- 세그먼트 조회/설정
- 상품권 회수
- 패스머니 지급/회수

### 5.4 매장 관리 API

- 주문 이력 조회/수정
- 영수증 데이터 입력

### 5.5 메시지 관리 API

- 발송 리스트 조회/수정/삭제
- 메시지 즉시 발송/재발송
- Production → Staging 메시지/패스링크 복사

### 5.6 Notion API

- QA Tool 버전 관리 페이지 조회

---

## 6. 데이터 검증 및 안전장치

### 6.1 운영 환경 보호

- **테스트 대상 검증**: 모든 데이터 조작 전 테스트 대상 등록 여부 확인
- **에러 처리**: 미등록 대상 조작 시도 시 차단 및 토스트 메시지
  - "테스트 대상 (#{번호/계정/매장})을 확인하세요."

### 6.2 Production 환경 안전장치

- **매장 등록**: 사업자번호 `452-87-01123` 또는 매장명 "패스오더" 포함 검증
- **테스트 번호**: 법인 테스트폰 번호만 화이트리스트 등록 가능 (추가 불가)

### 6.3 삭제 조건 검증

- **계정 삭제**: 모든 주문 취소 확인
- **상품권 회수**: 사용된 주문 모두 취소 확인
- **패스머니 회수**: 사용된 주문 모두 취소 확인
- **매장 삭제**: 모든 주문 취소 확인
- **번호 삭제**: 해당 번호로 생성된 모든 계정 삭제 확인

---

## 7. UI/UX 가이드라인

### 7.1 공통 UI 요소

- **복사 버튼**: 모든 식별자 필드 옆
- **토스트 메시지**: 성공/실패 피드백
- **컨펌 다이얼로그**: 중요 작업 전 확인
- **로딩 인디케이터**: API 호출 중

### 7.2 반응형

- 웹 기반이며 주 사용 환경은 데스크톱
- 태블릿/모바일 대응은 우선순위 낮음

---

## 14. 향후 확장 계획

### 14.1 프로젝트별 특수 기능

- 공통 기능 코어 + 프로젝트별 플러그인 구조
- 프로젝트별 설정 파일 관리

---

## 부록

### A. 용어 정리

- **패써**: 패스오더 사용자 (회원)
- **CI 값**: 본인인증 고유 식별값
- **세그먼트**: 사용자 행동 패턴 기반 분류
- **화이트리스트**: 테스트 허용 번호 목록
- **아하모먼트**: 신규 유저 전환 이벤트
