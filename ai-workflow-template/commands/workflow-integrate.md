# `/workflow-integrate` 커맨드

**사용 시점**: 시스템 통합 작업 시

**기능**:

- 중복 코드 제거
- 공통 모듈 추출
- 전체 구조 개선
- (선택) 성능 최적화
- 접근성 개선

**권장사항**:

- 모든 기능 구현 완료 (또는 대부분의 핵심 기능 완료)

**사용법**:

```
/workflow-integrate
```

---

## 목표

기능 간 중복을 제거하고 전체 코드 구조를 개선합니다.

---

## 권장사항

💡 **권장**: 다음 단계가 완료된 후 진행하세요.

- 모든 기능 구현 완료 (또는 대부분의 핵심 기능 완료)

완료되지 않은 경우 발생할 수 있는 문제:

- 통합 리팩토링 효과가 제한적일 수 있음
- E2E 테스트 시 일부 기능이 누락될 수 있음
- 전체 품질 검증이 불완전할 수 있음

계속 진행하시겠습니까?

---

### 1단계: API 연동 상태 확인 (시작 전)

**AI 작업**: `docs/workflows/memory.md`에서 API 연동 상태 확인

#### 🔔 API 연동 상태 재확인

"통합 작업을 시작하기 전에 API 연동 상태를 확인하겠습니다."

**현재 API 연동 상태**:

- ✅ **연동 완료**: [기능1], [기능2], ...
- ⏳ **더미 데이터 유지**: [기능3], [기능4], ...

**아직 연동되지 않은 API**:

- [기능3]: API 준비 상태 확인 필요
- [기능4]: API 준비 상태 확인 필요

**하나를 선택해주세요**:

- [ ] **지금 연동** (준비된 API만 선택적으로 연동)
- [ ] **나중에 연동** (더미 데이터 유지하고 통합 작업 진행)
- [ ] **부분 연동** (일부는 연동, 일부는 더미 유지)

**선택 옵션**:

- 연동할 기능: [기능1], [기능2], ...
- 연동하지 않을 기능: [기능3], [기능4], ...

⚠️ **선택 완료 후 통합 작업 진행**

---

### 2단계: 중복 코드 분석

**AI 작업**:

1. 전체 코드베이스 스캔
2. 중복 패턴 파악

**중복 대상**:

- 유사한 유틸리티 함수
- 반복되는 로직
- 중복 타입 정의
- 유사한 컴포넌트
- 중복 API 호출 패턴

**출력 형식**:

```typescript
interface Duplication {
  type: "utility" | "component" | "type" | "hook" | "constant";
  pattern: string; // '{중복 패턴 설명}'
  locations: string[]; // ['{파일 경로 1}', '{파일 경로 2}']
  suggestion: string; // '{통합 제안}'
  impact: "high" | "medium" | "low";
}
```

---

### 3단계: 공통 모듈 추출

**추출 대상**:

1. **공통 유틸리티**

   - 경로: `src/shared/utils/`
   - 📘 예시: formatPrice, formatDate, formatPhoneNumber 등

2. **공통 훅**

   - 경로: `src/shared/hooks/`
   - 📘 예시: usePagination, useDebounce, useLocalStorage 등

3. **공통 타입**

   - 경로: `src/shared/types/common.ts`
   - 📘 예시: PaginationParams, ErrorResponse, ApiResponse<T> 등

4. **공통 상수**
   - 경로: `src/shared/constants/app.ts`
   - 📘 예시: ITEMS_PER_PAGE, API_TIMEOUT, MAX_FILE_SIZE 등

---

### 4단계: 전체 구조 개선

**개선 항목**:

1. **폴더 구조 정리**

   - 일관성 없는 폴더 구조 통일
   - 파일 위치 재정리
   - 네이밍 컨벤션 통일

2. **임포트 경로 최적화**

   - tsconfig.json에서 절대 경로 설정
   - `@/components`, `@/utils` 같은 별칭 사용

3. **순환 의존성 제거**
   - 공통 모듈로 추출
   - 인터페이스 분리
   - 의존성 역전

---

### 5단계: 성능 최적화 (선택사항)

#### 🔔 사용자 입력 필요

"성능 최적화를 수행하시겠습니까?"

**최적화 필요 여부**:

- [ ] **예** - 성능 최적화 수행
- [ ] **아니오** - 나중에 개선

**"예" 선택 시**:

#### 🔔 성능 목표 설정

**성능 목표 설정**:

- 초기 로딩 시간 목표: `_________________`초 (기본: 3초)
- 페이지 전환 시간 목표: `_________________`초 (기본: 1초)
- 번들 사이즈 목표: `_________________`MB (기본: 1MB)

**최적화 항목** (필요한 것만 선택):

- [ ] React 최적화 (memo, callback, useMemo)
- [ ] 코드 스플리팅
- [ ] 번들 사이즈 최적화
- [ ] API 호출 최적화
- [ ] 이미지 최적화

**최적화 항목 세부사항**:

1. **React 최적화**

   - React.memo로 불필요한 리렌더링 방지
   - useCallback, useMemo 활용
   - 컴포넌트 분리

2. **코드 스플리팅**

   - React.lazy로 페이지별 분리
   - Suspense로 로딩 처리
   - 라우트 기반 분리

3. **번들 사이즈 최적화**

   - 사용하지 않는 코드 제거
   - 무거운 라이브러리 교체
   - Tree shaking 최적화

4. **API 호출 최적화**

   - React Query 캐싱 설정
   - staleTime, cacheTime 조정
   - 불필요한 refetch 방지

5. **이미지 최적화**
   - 지연 로딩 적용
   - WebP 포맷 사용
   - 사이즈 최적화

---

### 6단계: 접근성 개선

**체크리스트**:

- [ ] **키보드 네비게이션**: Tab 순서, 포커스 인디케이터, Enter/Space 동작, ESC 닫기
- [ ] **스크린 리더 지원**: Alt 텍스트, ARIA 속성, 랜드마크 역할, 폼 레이블
- [ ] **색상 대비**: WCAG AA 기준 충족 (4.5:1)
- [ ] **반응형 접근성**: 터치 타겟 44x44px 이상, 확대 시 레이아웃 유지

---

### 7단계: 통합 테스트 보완

**테스트 항목**:

1. **도메인 간 통합 테스트**

   - 경로: `__tests__/integration/cross-domain/`
   - 📘 예시: 장바구니 → 주문 플로우, 로그인 → 마이페이지 플로우

2. **에러 복구 테스트**

   - 📘 예시: API 실패 후 재시도, 네트워크 에러 처리, 타임아웃 처리

3. **성능 테스트**
   - 초기 로딩 시간 (목표: <3초)
   - 페이지 전환 시간 (목표: <1초)

---

### 8단계: 통합 검수

### 검수 가이드 (AI용)

**기본 원칙**: 프로젝트 규모 및 복잡도에 따라 유연하게 질문

**항상 물어볼 것**:

- 통합 작업이 완료되었는가?

**조건부 질문**:

- 중복 코드가 많았던 경우: 공통 모듈 추출이 적절한가?
- 성능 최적화를 수행한 경우: 성능 목표를 달성했는가?
- 접근성 개선을 수행한 경우: 접근성 기준을 충족하는가?

**질문 스타일**:

- 개방형 질문 선호
- 문제 발견 시 구체적으로 지적
- 개선 방안 제시

#### 🔔 사용자 검수

"전체 시스템 통합 및 리팩토링이 완료되었습니다."

**작업 결과**:

중복 코드 제거:

- ✅ 공통 유틸리티 N개 추출
- ✅ 공통 훅 N개 추출
- ✅ 공통 타입 N개 통합

구조 개선:

- ✅ 임포트 경로 최적화 (절대 경로)
- ✅ 순환 의존성 0개
- ✅ 폴더 구조 통일

성능 최적화 (수행한 경우):

- ✅ 번들 사이즈 X% 감소
- ✅ 초기 로딩 X.X초 (목표: <3초)
- ✅ 페이지 전환 X.X초 (목표: <1초)

접근성 개선:

- ✅ 키보드 네비게이션 완료
- ✅ ARIA 속성 추가
- ✅ 색상 대비 개선

테스트:

- ✅ 통합 테스트 N개 추가
- ✅ 테스트 통과율 100%
- ✅ 커버리지 X% (목표: 90% 이상)

**검수 권장사항**:

- 코드 구조가 깔끔한가?
- 성능이 목표를 충족하는가? (최적화 수행한 경우)
- 접근성이 개선되었는가?
- 테스트가 안정적인가?

**피드백**: (수정 필요 시 즉시 반영)

---

## 메모리 업데이트

**통합 작업 완료 시**:

```markdown
- [x] 통합 및 리팩토링
```

---

## 다음 단계

**통합 완료 후**:

- 🎉 E2E 테스트로 진행: `/workflow-e2e`

---

## 결과물 파일 경로

**통합 결과물**:

- `src/shared/utils/` - 공통 유틸리티
- `src/shared/hooks/` - 공통 훅
- `src/shared/types/` - 공통 타입
- `src/shared/constants/` - 공통 상수

**테스트**:

- `__tests__/integration/cross-domain/` - 도메인 간 통합 테스트

**문서**:

- `docs/architecture.md` - 최종 아키텍처
- `docs/performance.md` - 성능 최적화 결과 (최적화 수행한 경우)
